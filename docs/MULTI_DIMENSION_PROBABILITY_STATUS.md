# 多維命理與「真實機率」現狀說明

本文件說明目前姓名學、八字、塔羅、梅花易數等模組的**推算是否為真**，以及**機率／多維彙總**的實際作法。

---

## 一、各維度是否有「真實推算」？

| 維度 | 是否有真實推算 | 說明 |
|------|----------------|------|
| **八字** | ✅ 有 | 節氣、排盤、大運起運、五行強弱、十神、喜用、大運吉凶（優/平/劣）等，皆依規則計算。 |
| **姓名學** | ✅ 有 | 康熙筆畫、五格剖象、81 數理、三才、五行、生肖等，依規則計算；有 `overallScore` 加權綜合評分。 |
| **梅花易數** | ✅ 有 | 數字／時間／漢字起卦，64 卦、體用生克、吉凶斷辭，依規則計算；卦象與體用會轉成 `fortuneScore`（25/50/65/85 等）用於機率。 |
| **塔羅** | ⚠️ 部分 | **解讀**：凱爾特十字 10 張、牌義、正逆位、關鍵字正負向 → `fortuneScore`，有規則。**抽牌**：`Math.random()` 隨機抽牌、隨機正逆，**與問題／八字／當事人無綁定**。 |

---

## 二、「機率」怎麼來的？

- **八字**：系統未輸出 `fortuneScore`／`overallProbability`。多維彙總時多為 **50 或** 若有 `fullData.strength`（0–100）則採用，再依 domain 微調 ±2。
- **姓名學**：`overallScore`（0–100）來自五格、81 數理、三才、五行、生肖等加權，**當作該維度機率**使用。
- **梅花易數**：由卦象吉凶（大吉/吉/平/凶）與體用關係，映射為 **25 / 50 / 65 / 85** 等 `fortuneScore`，**當作該維度機率**使用。
- **塔羅**：由 10 張牌的正逆位與牌義關鍵字（正負向）算出 `fortuneScore`（0–100），**當作該維度機率**使用。  
  → 但抽牌為**隨機**，故「機率」是**對本次隨機結果的量化**，而非對問題／命盤的固定推算。

---

## 三、多維彙總怎麼做？

- **現行作法**：各維度取上述 `fortuneScore`／`overallScore`／`strength`（或 50），**只對「有數值」的維度做簡單算術平均**，得到「整體機率」。
- **沒有**：維度權重、貝葉斯、各派權重、因果模型等**聯合機率模型**。
- **result-generator** 另有一套 `calculateOverallLuck`：八字簡化為身強 75 / 否則 50、梅花吉 80 / 否則 60、塔羅**固定 70**、姓名 `overallScore` 或 75，再四者平均；且洞察／結論等有 **`Math.random()` 隨機挑句**，非由命理規則唯一決定。

---

## 四、總結：是否為「多維命理真實推算」後的「真實機率」？

- **各維度**：八字、姓名學、梅花易數**有依規則的真實推算**；塔羅**解讀**有規則，**抽牌**為隨機。
- **機率**：姓名、梅花、塔羅有**規則化的評分／機率映射**；八字多數時候**未**輸出嚴謹機率，常以 50 或簡化規則參與。
- **多維彙總**：**簡單平均**，且混有**固定值**（如塔羅 70）、**隨機選句**，**並非**多維命理聯合推算後的嚴謹「真實機率」。

因此，就現有實作而言，**尚不具備**「姓名學、八字、塔羅、梅花易數等多維命理**真實推算**後，給出**嚴謹真實機率**」的完整流程；而是各維度各自推算與評分，再以簡均等方式彙總為「整體機率」供參考。

---

## 五、若要做「真實機率」可考慮的方向

1. **八字**：從五行、十神、大運吉凶、喜用等訂出 0–100 評分或機率映射，並**穩定輸出**給多維彙總。
2. **塔羅**：若要有「與問題／當事人綁定」的推算，需定義抽牌規則（例如依問題、生日、時間等衍生種子），而非純 `Math.random()`。
3. **多維彙總**：訂定維度權重、加權公式或簡單聯合模型，取代單純平均；並去除**固定機率**與**隨機選句**，改為由各維度輸出與規則決定文案。
4. **揭露與標示**：在 UI 明確標示何者為「規則推算」、何者為「隨機抽牌」、整體機率為「多維簡均」等，避免誤解為嚴謹機率。

---

*最後更新：依目前 codebase 與多維機率邏輯整理。*
