<!DOCTYPE html>
    <html lang="zh-TW">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
        <meta name="description" content="éœæœˆä¹‹å…‰èƒ½é‡å åœå„€ï¼šæ•´åˆå…«å­—ã€æ¢…èŠ±æ˜“æ•¸ã€å¡”ç¾…ç‰Œçš„å¤šç¶­åº¦æ©Ÿç‡è©•ä¼°ï¼Œæä¾›å°ˆå±¬äº”è¡Œæ°´æ™¶é–‹é‹å»ºè­°ã€‚">
        <meta name="keywords" content="å…«å­—,æ¢…èŠ±æ˜“æ•¸,å¡”ç¾…ç‰Œ,å‘½ç†,å åœ,äº”è¡Œ,æ°´æ™¶,é–‹é‹">
        <meta name="theme-color" content="#2D0A0A">
        <meta property="og:title" content="éœæœˆä¹‹å…‰èƒ½é‡å åœå„€ v2.0">
        <meta property="og:description" content="æ•´åˆå…«å­—ã€æ¢…èŠ±æ˜“æ•¸ã€å¡”ç¾…ç‰Œçš„å¤šç¶­åº¦æ©Ÿç‡è©•ä¼°ï¼Œæä¾›å°ˆå±¬äº”è¡Œæ°´æ™¶é–‹é‹å»ºè­°ã€‚">
        <meta property="og:type" content="website">
        <meta property="og:locale" content="zh_TW">
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
        <meta http-equiv="Pragma" content="no-cache">
        <meta http-equiv="Expires" content="0">
        <title>éœæœˆä¹‹å…‰èƒ½é‡å åœå„€ v2.0</title>
        
        <link rel="stylesheet" href="css/main.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/tarot.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/bazi-display.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/responsive.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/ios-fixes.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/mobile-fix.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/result-section-override.css?v=HOTFIX-20260203-E">
        <link rel="stylesheet" href="css/mobile-scroll.css?v=HOTFIX-20260203-E">

        <!-- è¦–è¦ºå„ªåŒ–å±¤ï¼ˆç²¾æº–è¦†è“‹ï¼Œä¿ç•™åŸæœ‰çµæ§‹ï¼‰ -->
        <link rel="stylesheet" href="css/polish-theme.css?v=2.1.0">
        <!-- ç´…é‡‘å‚³çµ±ä¸­å¼é¢¨æ ¼ï¼ˆå…¨ç«™å¥—ç”¨ï¼‰ -->
        <link rel="stylesheet" href="css/theme-red-gold.css?v=2.2.0">
        <!-- UI/UX Hotfix Layer (Landing + Form Split + Result Summary) | HOTFIX-20260208-UIFLOW -->
        <style>
            /* === HOTFIX-20260208-UIFLOW (non-destructive additions) === */
            .landing-section{
                padding: 1.25rem 1rem 0.25rem;
                max-width: 980px;
                margin: 0 auto;
            }
            .landing-hero{
                border: 1px solid rgba(212,175,55,0.22);
                background: rgba(255,255,255,0.04);
                border-radius: 16px;
                padding: 1.25rem 1rem;
                box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            }
            .landing-hero h1{
                font-size: 1.35rem;
                margin: 0 0 0.5rem;
                line-height: 1.35;
            }
            .landing-hero p{
                margin: 0.35rem 0;
                color: rgba(255,255,255,0.78);
                line-height: 1.55;
            }
            .landing-bullets{
                margin: 0.75rem 0 0.9rem;
                padding-left: 1.15rem;
                color: rgba(255,255,255,0.82);
            }
            .landing-bullets li{ margin: 0.25rem 0; }
            .landing-cta-row{
                display: flex;
                gap: 0.75rem;
                flex-wrap: wrap;
                align-items: center;
                margin-top: 0.9rem;
            }
            .btn-hero{
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.85rem 1.05rem;
                border-radius: 14px;
                border: 1px solid rgba(212,175,55,0.45);
                background: rgba(212,175,55,0.15);
                color: #fff;
                font-weight: 700;
                cursor: pointer;
                text-decoration: none;
            }
            .btn-hero:focus-visible{ outline: 2px solid rgba(212,175,55,0.85); outline-offset: 3px; }
            .landing-trust{
                font-size: 0.9rem;
                color: rgba(255,255,255,0.68);
            }
            .form-advanced{
                margin-top: 0.9rem;
                border: 1px solid rgba(255,255,255,0.10);
                border-radius: 14px;
                background: rgba(255,255,255,0.03);
                padding: 0.75rem 0.85rem;
            }
            .form-advanced > summary{
                cursor: pointer;
                font-weight: 700;
                color: rgba(255,255,255,0.92);
                list-style: none;
            }
            .form-advanced > summary::-webkit-details-marker{ display:none; }
            .form-advanced .advanced-hint{
                margin: 0.4rem 0 0.75rem;
                color: rgba(255,255,255,0.65);
                font-size: 0.9rem;
            }
            .term-chip{
                display:inline-flex;
                align-items:center;
                justify-content:center;
                width: 18px;
                height: 18px;
                border-radius: 999px;
                border: 1px solid rgba(212,175,55,0.35);
                color: rgba(212,175,55,0.95);
                margin-left: 0.35rem;
                font-size: 12px;
                line-height: 1;
                user-select: none;
            }
            .result-first-look{
                border: 1px solid rgba(212,175,55,0.22);
                background: rgba(255,255,255,0.04);
                border-radius: 16px;
                padding: 1rem 1rem;
                margin-bottom: 0.85rem;
            }
            .result-first-look h3{
                margin: 0 0 0.6rem;
                font-size: 1.05rem;
            }
            .result-first-look .firstlook-row{
                display:flex;
                gap: 0.8rem;
                flex-wrap: wrap;
                align-items: center;
            }
            .firstlook-pill{
                border: 1px solid rgba(255,255,255,0.12);
                background: rgba(0,0,0,0.18);
                border-radius: 999px;
                padding: 0.45rem 0.75rem;
                font-weight: 700;
                color: rgba(255,255,255,0.92);
            }
            .firstlook-note{
                margin-top: 0.55rem;
                color: rgba(255,255,255,0.72);
                line-height: 1.5;
                font-size: 0.95rem;
            }
            /* Keep nav shop buttons from stealing attention on first screen (soften only) */
            .nav-shop-buttons{ opacity: 0.88; }
            /* Step1 è¡¨å–®ï¼šé–“è·çµ±ä¸€ã€éŒ¯èª¤ç‹€æ…‹ã€é€²éšæ”¶åˆ */
            #input-section .form-group{ margin-bottom: 1.25rem; }
            #input-section .form-group label{ font-size: 0.9375rem; }
            #input-section .form-group .input-hint,
            #input-section .form-group .hint-note{ font-size: 0.8125rem; color: rgba(255,255,255,0.55); margin-top: 0.25rem; line-height: 1.4; }
            #input-section .form-group.error input,
            #input-section .form-group.error select,
            #input-section .form-group.error textarea{ border-color: #c33; box-shadow: 0 0 0 1px #c33; }
            #input-section .form-group .error-msg{ display: none; color: #e88; font-size: 0.8125rem; margin-top: 0.25rem; line-height: 1.3; }
            #input-section .form-group .error-msg[style*="display: block"]{ display: block !important; }
            .form-advanced-solar .advanced-inner{ margin-top: 0.5rem; }
            .form-advanced-solar .solar-time-desc{ margin: 0 0 0.5rem; font-size: 0.9rem; }
            /* === end HOTFIX === */
        </style>


        <!-- æ‰‹æ©Ÿï¼šå–®ä¸€æ²å‹•å®¹å™¨ #page-scrollï¼Œé¿å… body æ²å‹•åœ¨éƒ¨åˆ†æ©Ÿå‹å¤±æ•ˆ -->
        <script>
        (function(){
          function setVh(){ try { document.documentElement.style.setProperty('--vh', (window.innerHeight * 0.01) + 'px'); } catch(e){} }
          if (typeof window !== 'undefined') {
            window.addEventListener('resize', setVh);
            window.addEventListener('orientationchange', setVh);
            setVh();
          }
        })();
        </script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link rel="icon" href="images/logo.jpg" type="image/jpeg">
        <script>if(document.location.protocol.match(/^https?:$/)){var l=document.createElement('link');l.rel='manifest';l.href='manifest.json?v=HOTFIX-20260203-E';document.head.appendChild(l);}</script>
        <link rel="apple-touch-icon" href="images/logo.jpg">
        <script type="application/ld+json">
        {"@context":"https://schema.org","@type":"WebApplication","name":"éœæœˆä¹‹å…‰èƒ½é‡å åœå„€","description":"æ•´åˆå…«å­—ã€æ¢…èŠ±æ˜“æ•¸ã€å¡”ç¾…ç‰Œçš„å¤šç¶­åº¦æ©Ÿç‡è©•ä¼°ï¼Œæä¾›å°ˆå±¬äº”è¡Œæ°´æ™¶é–‹é‹å»ºè­°","applicationCategory":"LifestyleApplication","inLanguage":"zh-TW"}
        </script>
    </head>
    <body>
        <div id="page-scroll" class="page-scroll">
        <noscript><p style="padding:2rem;text-align:center;background:#1a1520;color:#D4AF37;">æœ¬ç³»çµ±éœ€å•Ÿç”¨ JavaScript æ‰èƒ½é‹ä½œï¼Œè«‹åœ¨ç€è¦½å™¨è¨­å®šä¸­é–‹å•Ÿå¾Œé‡æ–°æ•´ç†é é¢ã€‚</p></noscript>
        <nav class="navbar">
            <div class="nav-container">
                <a href="https://sites.google.com/view/jingyue-light/" target="_blank" class="logo" rel="noopener noreferrer">
                    <img src="images/logo.jpg" alt="éœæœˆä¹‹å…‰èƒ½é‡å åœå„€" class="logo-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';">
                    <i class="fas fa-moon" style="display:none;"></i>
                    <span>éœæœˆä¹‹å…‰èƒ½é‡å åœå„€ v2.0</span>
                </a>
                <div class="nav-shop-buttons">
                    <a href="https://tw.shp.ee/2n5Mo2w" target="_blank" class="shop-btn shop-btn-shopee" rel="noopener noreferrer" title="ğŸ›’ è¦çš®é€›é€›ï¼ˆå…é‹ï¼‹é—œæ³¨9æŠ˜ï¼‰">
                        <i class="fas fa-shopping-cart"></i> è¦çš®é€›é€›
                    </a>
                    <a href="https://myship.7-11.com.tw/seller/profile?id=GM2601091690232" target="_blank" class="shop-btn shop-btn-711" rel="noopener noreferrer" title="ğŸ“¦ è³£è²¨ä¾¿ï¼ˆæ»¿åƒå…é‹ï¼‰">
                        <i class="fas fa-box"></i> è³£è²¨ä¾¿
                    </a>
                </div>
            </div>
        </nav>
    
        <!-- å…¨é è¼‰å…¥é®ç½©ï¼ˆè¨ˆç®—å…«å­—æ™‚é¡¯ç¤ºï¼‰ -->
        <div id="global-loading-overlay" class="global-loading-overlay" aria-live="polite" aria-busy="false" hidden>
            <div class="global-loading-content">
                <i class="fas fa-spinner fa-spin"></i>
                <span>æ­£åœ¨è¨ˆç®—å…«å­—å‘½ç›¤...</span>
            </div>
        </div>

        <main id="main-content" class="main-container" tabindex="-1">

            <section id="input-section" class="section active">
                <h2><i class="fas fa-user-edit"></i> å€‹äººè³‡æ–™è¼¸å…¥</h2>
                <div class="form-container">
                    <form id="personal-form">
                        <!-- 1. å•é¡Œé¡å‹ï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" data-field="question-type">
                            <label for="question-type"><i class="fas fa-tag"></i> å•é¡Œé¡å‹ <span class="required">*</span></label>
                            <select id="question-type" required aria-describedby="question-type-hint">
                                <option value="">è«‹é¸æ“‡å•é¡Œé¡å‹</option>
                                <option value="love">æ„›æƒ…</option>
                                <option value="career">äº‹æ¥­</option>
                                <option value="wealth">è²¡é‹</option>
                                <option value="health">å¥åº·</option>
                                <option value="general">é‹å‹¢ï¼ˆç¶œåˆï¼‰</option>
                                <option value="relationship">äººéš›</option>
                                <option value="family">å®¶åº­</option>
                                <option value="other">å…¶ä»–</option>
                            </select>
                            <small class="input-hint" id="question-type-hint">ä¾é¡å‹é¸æ“‡å¾Œï¼Œä¸‹æ–¹æœƒæœ‰å•é¡Œæ–¹å‘æç¤º</small>
                            <small class="error-msg" id="err-question-type" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 2. è«®è©¢å•é¡Œï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" data-field="question">
                            <label for="question"><i class="fas fa-question-circle"></i> è«®è©¢å•é¡Œ <span class="required">*</span></label>
                            <textarea id="question" rows="3" placeholder="è«‹è¼¸å…¥æ‚¨æƒ³è©¢å•çš„å•é¡Œ..." maxlength="500" aria-describedby="question-char-hint"></textarea>
                            <small class="input-hint" id="question-char-hint">0/500 å­—</small>
                            <small class="hint-note hint-system-note" id="question-probability-note">çµæœç‚ºåƒè€ƒç”¨ï¼Œä¸å…·å‘½é‹æˆ–é†«ç™‚ä¿è­‰ã€‚</small>
                            <small class="error-msg" id="err-question" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 3. æ€§åˆ¥ï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" data-field="gender">
                            <label><i class="fas fa-venus-mars"></i> æ€§åˆ¥ <span class="required">*</span></label>
                            <div class="radio-group radio-group-pill" role="group" aria-label="æ€§åˆ¥é¸æ“‡">
                                <label class="radio-label radio-label-pill">
                                    <input type="radio" name="gender" value="male">
                                    <span class="radio-text">ç”·</span>
                                </label>
                                <label class="radio-label radio-label-pill">
                                    <input type="radio" name="gender" value="female">
                                    <span class="radio-text">å¥³</span>
                                </label>
                            </div>
                            <small class="error-msg" id="err-gender" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 4. å‡ºç”Ÿæ—¥æœŸï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" data-field="birth-date">
                            <label for="birth-date"><i class="fas fa-calendar"></i> å‡ºç”Ÿæ—¥æœŸ <span class="required">*</span></label>
                            <input type="date" id="birth-date" required placeholder="è«‹é¸æ“‡å‡ºç”Ÿå¹´æœˆæ—¥" aria-describedby="err-birth-date">
                            <small class="input-hint">ä¾‹å¦‚ï¼š1990å¹´6æœˆ15æ—¥</small>
                            <small class="error-msg" id="err-birth-date" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 5. å‡ºç”Ÿæ™‚é–“ï¼ˆé¸å¡«ï¼Œé è¨­ 12:00ï¼‰ -->
                        <div class="form-group" data-field="birth-time">
                            <label for="birth-time"><i class="fas fa-clock"></i> å‡ºç”Ÿæ™‚é–“</label>
                            <input type="time" id="birth-time" placeholder="ä¸ç¢ºå®šå¯ç•™ç©ºï¼Œå°‡ä»¥12:00è¨ˆç®—">
                            <small class="input-hint">é¸å¡«ï¼Œä¸ç¢ºå®šå¯ç•™ç©º</small>
                        </div>
                        <!-- 6. å‡ºç”Ÿåœ°å€ï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" data-field="birth-country">
                            <label for="birth-country"><i class="fas fa-globe-asia"></i> å‡ºç”Ÿåœ°å€ <span class="required">*</span></label>
                            <select id="birth-country">
                                <option value="">é¸æ“‡åœ‹å®¶/åœ°å€</option>
                                <option value="TW">å°ç£</option>
                                <option value="CN">ä¸­åœ‹å¤§é™¸</option>
                                <option value="HK">é¦™æ¸¯</option>
                                <option value="MO">æ¾³é–€</option>
                                <option value="other">å…¶ä»–åœ°å€</option>
                            </select>
                            <small class="error-msg" id="err-birth-country" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 7. å‡ºç”ŸåŸå¸‚ï¼ˆå¿…å¡«ï¼‰ -->
                        <div class="form-group" id="city-container" data-field="birth-city">
                            <label for="birth-city"><i class="fas fa-city"></i> å‡ºç”ŸåŸå¸‚ <span class="required">*</span></label>
                            <select id="birth-city">
                                <option value="">è«‹å…ˆé¸æ“‡åœ°å€</option>
                            </select>
                            <small class="error-msg" id="err-birth-city" role="alert" aria-live="polite"></small>
                        </div>
                        <!-- 8. å§“åï¼ˆé¸å¡«ï¼‰ -->
                        <div class="form-group" data-field="name">
                            <label for="name"><i class="fas fa-signature"></i> å§“å</label>
                            <input type="text" id="name" placeholder="å¯ç•™ç©ºï¼ˆç”¨æ–¼ç¨±å‘¼ï¼‰" autocomplete="name">
                            <small class="input-hint">é¸å¡«ï¼Œä¸å½±éŸ¿åˆ†æ</small>
                        </div>

                        <!-- é€²éšï¼ˆå¯é¸ï¼‰ï¼šçœŸå¤ªé™½æ™‚ï¼Œé è¨­æ”¶åˆ -->
                        <details class="form-advanced form-advanced-solar" id="solar-time-section">
                            <summary><i class="fas fa-sliders-h"></i> é€²éšï¼ˆå¯é¸ï¼‰</summary>
                            <div class="advanced-inner">
                                <div class="solar-time-card" role="group" aria-labelledby="solar-time-heading">
                                    <div class="solar-time-header">
                                        <i class="fas fa-sun" aria-hidden="true"></i>
                                        <h3 id="solar-time-heading">çœŸå¤ªé™½æ™‚æ ¡æ­£</h3>
                                    </div>
                                    <div class="solar-time-body">
                                        <p class="solar-time-desc" id="solar-time-desc">ä¾å‡ºç”Ÿåœ°ç¶“åº¦æ ¡æ­£æ™‚é–“ï¼Œå¯æé«˜æ™‚æŸ±æº–ç¢ºåº¦ã€‚</p>
                                        <div class="solar-time-location" id="solar-time-location-hint" style="display:none;"><i class="fas fa-map-marker-alt"></i> <span id="solar-location-text">è«‹å…ˆé¸æ“‡å‡ºç”Ÿåœ°å€èˆ‡åŸå¸‚</span></div>
                                        <label class="solar-time-toggle">
                                            <input type="checkbox" id="true-solar-time" aria-describedby="solar-time-desc">
                                            <span class="solar-toggle-slider"></span>
                                            <span class="solar-toggle-label">å•Ÿç”¨æ ¡æ­£</span>
                                        </label>
                                    </div>
                                </div>
                                <div id="city-coordinates" class="coordinate-info" style="display:none;">
                                    <small>ç¶“åº¦: <span id="longitude">-</span>Â°E | ç·¯åº¦: <span id="latitude">-</span>Â°N</small>
                                </div>
                            </div>
                        </details>
    
                        <div class="form-actions">
                            <button type="button" class="btn btn-primary btn-next" id="step1-submit" data-next="meihua-section" disabled>
                                <i class="fas fa-arrow-right"></i> ä¸‹ä¸€æ­¥ï¼šæ¢…èŠ±æ˜“æ•¸
                            </button>
                        </div>
                    </form>
                </div>
            </section>
    
            <section id="bazi-section" class="section">
                <h2><i class="fas fa-calendar-alt"></i> å…«å­—å‘½ç›¤è¨ˆç®—</h2>
                
                <div class="time-correction-info" id="time-correction-info">
                    <div class="info-card">
                        <h3><i class="fas fa-sun"></i> æ™‚é–“æ ¡æ­£çµæœ</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">è¼¸å…¥æ™‚é–“</span>
                                <span class="info-value" id="input-time">å¾…è¼¸å…¥</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">çœŸå¤ªé™½æ™‚</span>
                                <span class="info-value" id="true-solar-time-display">è¨ˆç®—ä¸­...</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">æ ¡æ­£å·®å€¼</span>
                                <span class="info-value" id="time-diff">è¨ˆç®—ä¸­...</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ä½¿ç”¨æ™‚é–“</span>
                                <span class="info-value" id="final-time">è¨ˆç®—ä¸­...</span>
                            </div>
                        </div>
                    </div>
                </div>
    
                <div class="bazi-container">
                    <div class="bazi-header">
                        <h3>å››æŸ±å…«å­—å‘½ç›¤</h3>
                        <button class="btn btn-outline" id="calculate-bazi">
                            <i class="fas fa-calculator"></i> è¨ˆç®—å…«å­—
                        </button>
                    </div>
                    
                    <div class="bazi-grid" id="bazi-grid">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i> è¨ˆç®—ä¸­...
                        </div>
                    </div>
    
                    <div class="bazi-details" id="bazi-details" style="display: none;">
                        <!-- è©³ç´°ä¿¡æ¯å·²æ•´åˆåˆ° bazi-grid ä¸­ï¼Œæ­¤è™•ä¿ç•™ä»¥å…¼å®¹èˆŠä»£ç¢¼ -->
                        <div class="details-row">
                            <div class="detail-item">
                                <span class="detail-label">æ—¥ä¸»</span>
                                <span class="detail-value" id="day-master">å¾…è¨ˆç®—</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">äº”è¡Œ</span>
                                <span class="detail-value" id="wuxing-balance">å¾…è¨ˆç®—</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">èº«å¼·èº«å¼±</span>
                                <span class="detail-value" id="strength">å¾…è¨ˆç®—</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">å–œç”¨ç¥</span>
                                <span class="detail-value" id="favorable-elements">å¾…è¨ˆç®—</span>
                            </div>
                        </div>
                    </div>
                </div>
    
                <div class="section-actions">
                    <button type="button" class="btn btn-outline btn-prev" data-prev="input-section">
                        <i class="fas fa-arrow-left"></i> ä¸Šä¸€æ­¥
                    </button>
                    <button type="button" class="btn btn-primary btn-next" data-next="meihua-section">
                        <i class="fas fa-arrow-right"></i> ä¸‹ä¸€æ­¥ï¼šæ¢…èŠ±æ˜“æ•¸
                    </button>
                </div>
            </section>
    
            <section id="meihua-section" class="section">
                <h2><i class="fas fa-yin-yang"></i> æ¢…èŠ±æ˜“æ•¸èµ·å¦</h2>
                
                <div class="meihua-container">
                    <div class="method-selection">
                        <h3>é¸æ“‡èµ·å¦æ–¹æ³•</h3>
                        <div class="method-tabs">
                            <button class="method-tab active" data-method="time">
                                <i class="fas fa-clock"></i> æ™‚é–“èµ·å¦
                            </button>
                            <button class="method-tab" data-method="number">
                                <i class="fas fa-sort-numeric-up"></i> æ•¸å­—èµ·å¦
                            </button>
                            <button class="method-tab" data-method="character">
                                <i class="fas fa-font"></i> æ¼¢å­—èµ·å¦
                            </button>
                            <button class="method-tab" data-method="random">
                                <i class="fas fa-random"></i> éš¨æ©Ÿèµ·å¦
                            </button>
                        </div>
                        <p class="method-hint" style="margin-top: 0.75rem; color: rgba(255,255,255,0.7); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> èˆ‡å•é¡Œç›¸é—œçš„èµ·å¦æ–¹å¼ï¼ˆæ™‚é–“ï¼æ•¸å­—ï¼æ¼¢å­—ï¼‰æ›´åˆ©è§£è®€ï¼Œå»ºè­°ä¾å•é¡Œé¸æ“‡å°æ‡‰æ–¹æ³•ã€‚
                        </p>
                    </div>
    
                    <div class="method-content active" id="time-method">
                        <div class="method-form">
                            <div class="form-group">
                                <label for="meihua-date"><i class="fas fa-calendar"></i> èµ·å¦æ—¥æœŸ</label>
                                <input type="date" id="meihua-date" readonly class="readonly-input">
                                <small style="color: var(--text-muted); display: block; margin-top: 5px;">å°‡è‡ªå‹•ä½¿ç”¨æŒ‰ä¸‹æŒ‰éˆ•æ™‚çš„ç•¶å‰æ™‚é–“</small>
                            </div>
                            <div class="form-group">
                                <label for="meihua-time"><i class="fas fa-clock"></i> èµ·å¦æ™‚é–“</label>
                                <input type="time" id="meihua-time" readonly class="readonly-input">
                            </div>
                            <button class="btn btn-primary" id="calculate-time-hexagram">
                                <i class="fas fa-calculator"></i> æ™‚é–“èµ·å¦
                            </button>
                            <p style="margin-top: 15px; color: var(--text-muted); font-size: 0.9em;">
                                <i class="fas fa-info-circle"></i> é»æ“ŠæŒ‰éˆ•æ™‚å°‡è‡ªå‹•ä½¿ç”¨ç•¶å‰æ™‚é–“é€²è¡Œèµ·å¦
                            </p>
                        </div>
                    </div>
    
                    <div class="method-content" id="number-method">
                        <div class="method-form">
                            <div class="form-group">
                                <label for="number1">ç¬¬ä¸€çµ„æ•¸å­—ï¼ˆä¸Šå¦ï¼‰</label>
                                <input type="number" id="number1" min="1" max="999" placeholder="1-999">
                            </div>
                            <div class="form-group">
                                <label for="number2">ç¬¬äºŒçµ„æ•¸å­—ï¼ˆä¸‹å¦ï¼‰</label>
                                <input type="number" id="number2" min="1" max="999" placeholder="1-999">
                            </div>
                            <div class="form-group">
                                <label for="number3">ç¬¬ä¸‰çµ„æ•¸å­—ï¼ˆå‹•çˆ»ï¼‰</label>
                                <input type="number" id="number3" min="1" max="6" placeholder="1-6">
                            </div>
                            <button class="btn btn-primary" id="calculate-number-hexagram">
                                <i class="fas fa-calculator"></i> æ•¸å­—èµ·å¦
                            </button>
                        </div>
                    </div>
    
                    <div class="method-content" id="character-method">
                        <div class="method-form">
                            <div class="form-group">
                                <label for="meihua-character">è¼¸å…¥æ¼¢å­—ï¼ˆ1-3å€‹ï¼‰</label>
                                <input type="text" id="meihua-character" placeholder="å¦‚ï¼šæ„Ÿæƒ…">
                                <small>ç³»çµ±å°‡æ ¹æ“šç­†ç•«æ•¸è¨ˆç®—å¦è±¡</small>
                            </div>
                            <button class="btn btn-primary" id="calculate-character-hexagram">
                                <i class="fas fa-calculator"></i> æ¼¢å­—èµ·å¦
                            </button>
                        </div>
                    </div>
    
                    
                <!-- éš¨æ©Ÿèµ·å¦ -->
                <div class="method-content" id="random-method">
                    <div class="method-form">
                        <div class="form-group">
                            <label><i class="fas fa-random"></i> éš¨æ©Ÿèµ·å¦</label>
                            <small style="color: var(--text-muted); display: block; margin-top: 5px;">æŒ‰ä¸€æ¬¡å°±æœƒç”¢ç”Ÿä¸€æ¬¡æ–°çš„å¦è±¡ï¼ˆæœ¬å¦ / äº’å¦ / è®Šå¦æœƒåŒæ­¥æ›´æ–°ï¼‰</small>
                        </div>
                        <button class="btn btn-primary" id="calculate-random-hexagram">
                            <i class="fas fa-dice"></i> éš¨æ©Ÿèµ·å¦
                        </button>
                    </div>
                </div>

<div class="hexagram-display" id="hexagram-display">
                        <div class="hexagram-container">
                            <div class="hexagram-info">
                                <h3>æœ¬å¦</h3>
                                <div class="hexagram-symbol" id="ben-hexagram">ä·</div>
                                <div class="hexagram-name" id="ben-name">å¤ç‚ºåœ°</div>
                            </div>
                            <div class="hexagram-info">
                                <h3>äº’å¦</h3>
                                <div class="hexagram-symbol" id="hu-hexagram">ä·–</div>
                                <div class="hexagram-name" id="hu-name">å±±åœ°å‰</div>
                            </div>
                            <div class="hexagram-info">
                                <h3>è®Šå¦</h3>
                                <div class="hexagram-symbol" id="bian-hexagram">ä·‡</div>
                                <div class="hexagram-name" id="bian-name">æ°´åœ°æ¯”</div>
                            </div>
                        </div>
    
                        <div class="hexagram-details">
                            <div class="detail-item">
                                <span class="detail-label">é«”ç”¨é—œä¿‚</span>
                                <span class="detail-value" id="tiyong-relation">é«”ç”¨æ¯”å’Œ</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">å‰å‡¶åˆ¤æ–·</span>
                                <span class="detail-value" id="fortune-judgment">å°å‰</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">å‹•çˆ»</span>
                                <span class="detail-value" id="dongyao">åˆå…­</span>
                            </div>
                        </div>
    
                        <div class="hexagram-interpretation">
                            <h4><i class="fas fa-comment-alt"></i> å¦è±¡è§£è®€</h4>
                            <div class="interpretation-text" id="hexagram-interpretation">
                                å¦è±¡é¡¯ç¤ºï¼šå¤ç‚ºåœ°ï¼Œåœ°å‹¢å¤ï¼Œå›å­ä»¥åšå¾·è¼‰ç‰©ã€‚é«”ç”¨æ¯”å’Œï¼Œå‰ã€‚è¡¨ç¤ºç•¶å‰æƒ…æ³è¼ƒç‚ºç©©å®šï¼Œä½†é€²å±•ç·©æ…¢ã€‚
                            </div>
                        </div>
                    </div>
                </div>
    
                <div class="section-actions">
                    <button type="button" class="btn btn-outline btn-prev" data-prev="input-section">
                        <i class="fas fa-arrow-left"></i> ä¸Šä¸€æ­¥
                    </button>
                    <button type="button" class="btn btn-primary btn-next" data-next="tarot-section">
                        <i class="fas fa-arrow-right"></i> ä¸‹ä¸€æ­¥ï¼šå¡”ç¾…ç‰Œ
                    </button>
                    <button type="button" class="btn btn-outline" id="skip-meihua" title="ç•¥éèµ·å¦ï¼Œç›´æ¥é€²å…¥å¡”ç¾…">
                        <i class="fas fa-forward"></i> è·³éæ¢…èŠ±
                    </button>
                </div>
            </section>
    
            <section id="tarot-section" class="section">
                <h2><i class="fas fa-cards"></i> é‡‘è‰²é»æ˜å¡”ç¾…ç‰Œ</h2>
                
                <div class="tarot-container">
                    <div class="draw-area" id="draw-area">
                        <div class="draw-instruction">
                            <h3><i class="fas fa-hand-pointer"></i> æŠ½é¸ç‰Œå¡</h3>
                            <p>è«‹é»æ“Šåœ“åœˆä¸­çš„ç‰Œå †æŠ½å–10å¼µç‰Œã€‚å‰©é¤˜: <span id="cards-left">10</span> å¼µ</p>
                        </div>
                        
                        <div class="draw-circle" id="draw-circle">
                            </div>
                        
                        <div class="draw-controls">
                            <button class="btn btn-outline" id="auto-draw">
                                <i class="fas fa-bolt"></i> å¿«é€ŸæŠ½ç‰Œ
                            </button>
                            <button class="btn btn-primary" id="finish-draw" disabled>
                                <i class="fas fa-check"></i> å®ŒæˆæŠ½ç‰Œ
                            </button>
                        </div>
                    </div>
    
                    <div class="spread-area" id="spread-area" style="display: none;">
                        <div class="spread-instruction">
                            <h3><i class="fas fa-cross"></i> å‡±çˆ¾ç‰¹åå­—ç‰Œé™£</h3>
                            <p>è«‹æŒ‰ç…§ç‰Œé™£ä½ç½®é»æ“Šç‰Œå¡ç¿»é¢ï¼Œäº†è§£æ¯å¼µç‰Œçš„æ„ç¾©ã€‚</p>
                        </div>
                        
                        <div class="celtic-cross-layout" id="celtic-cross-layout">
                            <div class="spread-position pos-1" data-position="1">
                                <div class="position-label">1. æ ¸å¿ƒç¾æ³</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="0">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front">
                                                </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-2" data-position="2">
                                <div class="position-label">2. é˜»ç¤™å› ç´ </div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="1">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-3" data-position="3">
                                <div class="position-label">3. éå»åŸºç¤</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="2">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-4" data-position="4">
                                <div class="position-label">4. æœªä¾†ç™¼å±•</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="3">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-5" data-position="5">
                                <div class="position-label">5. å¯èƒ½çµæœ</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="4">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-6" data-position="6">
                                <div class="position-label">6. è¿‘æœŸæœªä¾†</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="5">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-7" data-position="7">
                                <div class="position-label">7. è‡ªæˆ‘æ…‹åº¦</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="6">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-8" data-position="8">
                                <div class="position-label">8. ç’°å¢ƒå½±éŸ¿</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="7">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-9" data-position="9">
                                <div class="position-label">9. å¸Œæœ›ææ‡¼</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="8">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="spread-position pos-10" data-position="10">
                                <div class="position-label">10. æœ€çµ‚çµæœ</div>
                                <div class="card-slot">
                                    <div class="tarot-card" data-card-id="9">
                                        <div class="card-flip">
                                            <div class="card-face back">
                                                <img src="images/back.jpg" alt="ç‰ŒèƒŒé¢" class="card-back-image">
                                            </div>
                                            <div class="card-face front"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="spread-controls">
                            <button class="btn btn-outline" id="flip-all">
                                <i class="fas fa-sync-alt"></i> å…¨éƒ¨ç¿»ç‰Œ
                            </button>
                            <button class="btn btn-primary" id="proceed-to-result">
                                <i class="fas fa-chart-bar"></i> é€²è¡Œåˆ†æ
                            </button>
                        </div>
                    </div>
    
                    <div class="card-interpretation-modal" id="card-interpretation-modal">
                        <div class="modal-content">
                            <button class="modal-close">&times;</button>
                            <div class="modal-body">
                                <div class="card-display">
                                    <div class="card-image">
                                        <img id="modal-card-image" src="images/back.jpg" alt="å¡”ç¾…ç‰Œ">
                                    </div>
                                    <div class="card-info">
                                        <h3 id="modal-card-name">ç‰Œå</h3>
                                        <div class="card-orientation" id="modal-card-orientation">æ­£ä½</div>
                                        <div class="card-details">
                                            <div class="detail"><span>ä½ç½®:</span> <span id="modal-position">æ ¸å¿ƒç¾æ³</span></div>
                                            <div class="detail"><span>å…ƒç´ :</span> <span id="modal-element">åœŸ</span></div>
                                            <div class="detail"><span>é‡‘è‰²é»æ˜:</span> <span id="modal-golden-dawn">æ„ç¾©</span></div>
                                        </div>
                                        <div class="card-meaning">
                                            <h4>ç‰Œç¾©</h4>
                                            <p id="modal-meaning">ç‰Œç¾©è§£é‡‹...</p>
                                        </div>
                                        <div class="card-advice">
                                            <h4>å»ºè­°</h4>
                                            <p id="modal-advice">è¡Œå‹•å»ºè­°...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    
                <div class="section-actions">
                    <button type="button" class="btn btn-outline btn-prev" data-prev="meihua-section">
                        <i class="fas fa-arrow-left"></i> ä¸Šä¸€æ­¥
                    </button>
                    <button type="button" class="btn btn-primary" id="skip-tarot">
                        <i class="fas fa-forward"></i> è·³éå¡”ç¾…ç‰Œ
                    </button>
                </div>
            </section>
    
            <section id="result-section" class="section">
                <h2><i class="fas fa-chart-bar"></i> ç¶œåˆåˆ†æçµæœ</h2>
                
                <div class="bazi-container">
                    <div class="result-overview" id="result-overview">
                        <div class="input-summary-compact" id="input-summary-card" style="display: none;" aria-label="æœ¬æ¬¡åˆ†æè¼¸å…¥æ‘˜è¦">
                            <span class="input-summary-label"><i class="fas fa-info-circle"></i> æœ¬æ¬¡è¼¸å…¥</span>
                            <span id="input-summary-content" class="input-summary-text"></span>
                        </div>
                        
                        <!-- First Look Summary | HOTFIX-20260208-UIFLOW -->
                        <div class="result-first-look" id="result-first-look" aria-label="ä¸€å¥è©±çµè«–">
                            <h3><i class="fas fa-bolt"></i> ä¸€å¥è©±çµè«–</h3>
                            <div class="firstlook-row">
                                <span class="firstlook-pill" id="firstlook-verdict">ç­‰å¾…åˆ†æâ€¦</span>
                                <span class="firstlook-pill" id="firstlook-prob">å¯èƒ½æ€§ï¼š0%</span>
                            </div>
                            <div class="firstlook-note" id="firstlook-reason">å®Œæˆåˆ†æå¾Œï¼Œé€™è£¡æœƒå…ˆçµ¦ä½ ã€Œæ–¹å‘ï¼‹ä¸€å¥ç†ç”±ã€ï¼Œä¸‹é¢å†çœ‹å®Œæ•´æ‹†è§£ã€‚</div>
                        </div>

                        <div class="overview-card" id="section-answer">
                            <h3><i class="fas fa-bullseye"></i> ã€å•é¡Œã€‘</h3>
                            <div class="question-display" id="question-display"></div>
                            <div id="category-warning-banner" class="category-warning-banner" style="display:none;" role="alert" aria-live="polite"></div>
                            <div class="direct-answer">
                                <h4>ç›´æ¥å›ç­”</h4>
                                <p class="answer-text answer-text-summary" id="direct-answer">åˆ†æä¸­...</p>
                                <p class="principle-ref" id="direct-answer-principle" aria-hidden="true"></p>
                            </div>
                            <div class="answer-factors" id="answer-factors" style="display:none;">
                                <h4>å½±éŸ¿å› å­</h4>
                                <details class="details-expand details-factors" id="details-factors">
                                    <summary class="details-summary" id="factors-summary">é»æ“Šå±•é–‹å®Œæ•´å½±éŸ¿å› å­</summary>
                                    <ul id="answer-factors-list"></ul>
                                </details>
                            </div>
                            <div class="answer-suggestions" id="answer-suggestions" style="display:none;">
                                <h4>3 æ¢é—œéµå»ºè­°</h4>
                                <details class="details-expand details-suggestions" id="details-suggestions">
                                    <summary class="details-summary" id="suggestions-summary">é»æ“Šå±•é–‹ 3 æ¢å»ºè­°</summary>
                                    <ol id="answer-suggestions-list"></ol>
                                </details>
                            </div>
                        </div>
                        
                        <div class="probability-meter">
                            <div class="meter-header">
                                <h4>å¯èƒ½æ€§è©•ä¼°</h4>
                                <span class="probability-value" id="overall-probability">0%</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill" id="meter-fill" style="width: 0%"></div>
                            </div>
                            <div class="meter-labels">
                                <span>0%</span>
                                <span>25%</span>
                                <span>50%</span>
                                <span>75%</span>
                                <span>100%</span>
                            </div>
                            <p class="probability-note" aria-hidden="true">å…«å­—ã€ç´«å¾®æ–—æ•¸ã€å§“åå­¸ã€æ¢…èŠ±æ˜“æ•¸ã€å¡”ç¾…å‡é‡å°æ‚¨è¼¸å…¥çš„å•é¡Œèˆ‡ç•¶ä¸‹è±¡å¾µåˆ†åˆ¥è©•åˆ†å¾ŒåŠ æ¬Šå½™ç¸½ã€‚</p>
                            <div class="probability-breakdown-reasons" id="probability-breakdown-reasons" aria-label="å„ç¶­åº¦è©•åˆ†èˆ‡ç†ç”±"></div>
                        </div>
                    </div>
    
                    <!-- ã€è™•æ–¹ã€‘å°ˆå±¬æ ¡æº–è™•æ–¹ï¼šæ¯é¡†æ°´æ™¶ä¸€å¼µå¡ç‰‡ -->
                    <div class="lucky-item-recommendation-card" id="crystal-recommendation-card">
                        <div class="recommendation-header">
                            <i class="fas fa-gem"></i>
                            <h3>ã€è™•æ–¹ã€‘ğŸ’ æ‚¨çš„å°ˆå±¬æ ¡æº–è™•æ–¹</h3>
                        </div>
                        <div class="recommendation-content crystal-recommendation-content">
                            <div id="crystal-cards-container" class="crystal-cards-container" style="display:none;"></div>
                            <div id="crystal-legacy-block">
                                <p class="crystal-recommendation-intro" id="crystal-recommendation-intro">å»ºè­°è£œå¼· <strong id="crystal-target-element">â€”</strong> è¡Œèƒ½é‡ã€‚</p>
                                <p class="crystal-recommendation-stones" id="crystal-recommendation-stones">æ¨è–¦é…æˆ´ï¼š<span id="crystal-stones-list">â€”</span></p>
                                <p class="crystal-recommendation-desc" id="crystal-recommendation-desc">åŠŸæ•ˆï¼š<span id="crystal-reason-text">â€”</span></p>
                                <p class="crystal-recommendation-wearing" id="crystal-wearing-text" style="display:none;"><i class="fas fa-hand-holding-heart"></i> ä½©æˆ´æ–¹å¼ï¼š<span id="crystal-wearing-span">â€”</span></p>
                                <p class="crystal-recommendation-taboos" id="crystal-taboos-text" style="display:none;"><i class="fas fa-exclamation-triangle"></i> æ³¨æ„äº‹é …ï¼š<span id="crystal-taboos-span">â€”</span></p>
                            </div>
                            <p class="crystal-recommendation-disclaimer" id="crystal-disclaimer-text"><i class="fas fa-info-circle"></i> <span id="crystal-disclaimer-span">æœ¬å»ºè­°åƒ…ä¾›èƒ½é‡æ ¡æº–åƒè€ƒï¼Œä¸å…·é†«ç™‚æˆ–å‘½é‹ä¿è­‰æ•ˆåŠ›ã€‚</span></p>
                            <p class="crystal-recommendation-cta">
                                <i class="fas fa-arrow-down"></i> é»æ“Šå³ä¸‹è§’æŒ‰éˆ•ï¼Œå‰å¾€è³£å ´æœå°‹ä¸Šè¿°æ°´æ™¶ï¼Œæˆ–é»æ“Šã€Œæˆ‘è¦å®¢è£½ã€ç‚ºæ‚¨æ‰“é€ å°ˆå±¬æ‰‹éŠã€‚
                            </p>
                        </div>
                    </div>
    
                    <div class="dimension-analysis" id="section-breakdown">
                        <h3><i class="fas fa-layer-group"></i> ã€æ‹†è§£ã€‘å…«å­—ï¼æ¢…èŠ±ï¼å¡”ç¾…</h3>
                        
                        <div class="dimension-tabs" role="tablist" aria-label="åˆ†æç¶­åº¦åˆ‡æ›">
                            <button class="dimension-tab active" id="tab-bazi" role="tab" aria-selected="true" aria-controls="bazi-pane" data-dimension="bazi">å…«å­—å‘½ç†</button>
                            <button class="dimension-tab" id="tab-meihua" role="tab" aria-selected="false" aria-controls="meihua-pane" data-dimension="meihua">æ¢…èŠ±æ˜“æ•¸</button>
                            <button class="dimension-tab" id="tab-tarot" role="tab" aria-selected="false" aria-controls="tarot-pane" data-dimension="tarot">å¡”ç¾…ç‰Œé™£</button>
                            <button class="dimension-tab" id="tab-ziwei" role="tab" aria-selected="false" aria-controls="ziwei-pane" data-dimension="ziwei">ç´«å¾®æ–—æ•¸</button>
                            <button class="dimension-tab" id="tab-name" role="tab" aria-selected="false" aria-controls="name-pane" data-dimension="name">å§“åå­¸</button>
                        </div>
                        
                        <div class="dimension-content">
                            <div class="dimension-pane active" id="bazi-pane" role="tabpanel" aria-labelledby="tab-bazi" tabindex="0">
                                <div class="bazi-result" id="bazi-result">
                                    <div class="analysis-grid-container">
                                        <!-- åç¥èˆ‡è—å¹²ï¼šä¸€èˆ¬ä½¿ç”¨è€…ä¸æ˜“ç†è§£ï¼Œå·²éš±è— -->
                                        <div class="analysis-card analysis-card-tengods" id="tengods-card" style="display:none !important;">
                                            <div class="analysis-header">
                                                <i class="fas fa-sitemap"></i> åç¥èˆ‡è—å¹²è©³è§£
                                            </div>
                                            <div class="gods-detail-grid" id="ui-gods-grid">
                                                <div class="gods-column">
                                                    <span class="gods-col-title">å¹´æŸ±</span>
                                                    <span class="gods-item">-</span>
                                                    <span class="gods-item">-</span>
                                                </div>
                                                <div class="gods-column">
                                                    <span class="gods-col-title">æœˆæŸ±</span>
                                                    <span class="gods-item">-</span>
                                                    <span class="gods-item">-</span>
                                                </div>
                                                <div class="gods-column">
                                                    <span class="gods-col-title">æ—¥æŸ±</span>
                                                    <span class="gods-item">æ—¥ä¸»</span>
                                                    <span class="gods-item">-</span>
                                                </div>
                                                <div class="gods-column">
                                                    <span class="gods-col-title">æ™‚æŸ±</span>
                                                    <span class="gods-item">-</span>
                                                    <span class="gods-item">-</span>
                                                </div>
                                            </div>
                                        </div>
    
                                        <!-- SECTION 2: äº”è¡Œå¼·å¼± | å–œç”¨èˆ‡ç¥ç… â€” å–®è¡Œ 50/50 ä¸¦æ’ -->
                                        <div class="analysis-row-wuxing-shensha">
                                        <div class="analysis-card analysis-card-wuxing">
                                            <div class="analysis-header">
                                                <i class="fas fa-chart-pie"></i> äº”è¡Œå¼·å¼±åˆ†ä½ˆ
                                            </div>
                                            <div class="element-bar-group" id="ui-elements-bar">
                                                <div class="element-row">
                                                    <span class="element-label el-gold">é‡‘</span>
                                                    <div class="progress-track">
                                                        <div class="progress-fill bg-gold" style="width: 20%;"></div>
                                                    </div>
                                                    <span class="element-value">20%</span>
                                                </div>
                                                <div class="element-row">
                                                    <span class="element-label el-wood">æœ¨</span>
                                                    <div class="progress-track">
                                                        <div class="progress-fill bg-wood" style="width: 20%;"></div>
                                                    </div>
                                                    <span class="element-value">20%</span>
                                                </div>
                                                <div class="element-row">
                                                    <span class="element-label el-water">æ°´</span>
                                                    <div class="progress-track">
                                                        <div class="progress-fill bg-water" style="width: 20%;"></div>
                                                    </div>
                                                    <span class="element-value">20%</span>
                                                </div>
                                                <div class="element-row">
                                                    <span class="element-label el-fire">ç«</span>
                                                    <div class="progress-track">
                                                        <div class="progress-fill bg-fire" style="width: 20%;"></div>
                                                    </div>
                                                    <span class="element-value">20%</span>
                                                </div>
                                                <div class="element-row">
                                                    <span class="element-label el-earth">åœŸ</span>
                                                    <div class="progress-track">
                                                        <div class="progress-fill bg-earth" style="width: 20%;"></div>
                                                    </div>
                                                    <span class="element-value">20%</span>
                                                </div>
                                            </div>
                                        </div>
    
                                        <div class="analysis-card analysis-card-shensha">
                                            <div class="analysis-header">
                                                <i class="fas fa-star"></i> å–œç”¨èˆ‡ç¥ç…
                                            </div>
                                            <div id="ui-shensha-content">
                                                <div style="margin-bottom: 1rem;">
                                                    <p style="font-size:0.9rem; margin-bottom:5px; color:rgba(255,255,255,0.6);">å–œç”¨ç¥ï¼š</p>
                                                    <div class="tag-container">
                                                        <span class="bazi-tag tag-favorable">è¨ˆç®—ä¸­</span>
                                                    </div>
                                                </div>
                                                <div style="margin-bottom: 1rem;">
                                                    <p style="font-size:0.9rem; margin-bottom:5px; color:rgba(255,255,255,0.6);">å¿Œç¥ï¼š</p>
                                                    <div class="tag-container">
                                                        <span class="bazi-tag tag-unfavorable">è¨ˆç®—ä¸­</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                        <div class="dayun-container" id="dayun-container">
                                            <h4><i class="fas fa-hourglass-half"></i> å¤§é‹æµå¹´</h4>
                                            <div class="startLuckTop" id="dayun-start-luck-top" style="display:none;" aria-live="polite"></div>
                                            <div class="dayun-timeline fortune-timeline-container" id="dayun-timeline"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="dimension-pane" id="meihua-pane" role="tabpanel" aria-labelledby="tab-meihua" tabindex="0">
                                
                    <div class="method-content" id="random-method">
                        <div class="method-form">
                            <div class="form-group">
                                <label><i class="fas fa-random"></i> éš¨æ©Ÿèµ·å¦</label>
                                <small style="color: var(--text-muted); display:block; margin-top:5px;">æ¯æ¬¡æŒ‰ä¸‹éƒ½æœƒé‡æ–°éš¨æ©Ÿç”¢ç”Ÿä¸Šå¦ / ä¸‹å¦ / å‹•çˆ»ã€‚</small>
                            </div>
                            <button class="btn btn-primary" id="calculate-random-hexagram">
                                <i class="fas fa-dice"></i> éš¨æ©Ÿèµ·å¦
                            </button>
                        </div>
                    </div>
<div class="meihua-result" id="meihua-result">
                                    </div>
                            </div>
                            
                            <div class="dimension-pane" id="tarot-pane" role="tabpanel" aria-labelledby="tab-tarot" tabindex="0">
                                <div class="tarot-result" id="tarot-result">
                                    </div>
                            </div>
                            
                            <div class="dimension-pane" id="ziwei-pane" role="tabpanel" aria-labelledby="tab-ziwei" tabindex="0">
                                <div class="ziwei-result" id="ziwei-result">
                                    <p class="no-data-note"><i class="fas fa-info-circle"></i> è«‹å…ˆå¡«å¯«å‡ºç”Ÿæ—¥æœŸã€æ™‚é–“èˆ‡æ€§åˆ¥ï¼Œå®Œæˆåˆ†æå¾Œé¡¯ç¤ºç´«å¾®æ˜Ÿç›¤ã€‚</p>
                                </div>
                            </div>
                            
                            <div class="dimension-pane" id="name-pane" role="tabpanel" aria-labelledby="tab-name" tabindex="0">
                                <div class="name-result" id="name-result">
                                    </div>
                            </div>
                        </div>
                    </div>
    
                    <div class="final-conclusion">
                        <h3><i class="fas fa-star"></i> ç¶œåˆçµè«–</h3>
                        <div class="conclusion-content" id="conclusion-content">
                            </div>
<!-- è¡Œå‹•è¨ˆåŠƒ / æ™‚æ©Ÿå»ºè­°ï¼šå·²ç§»é™¤ï¼ˆè‹¥æœªä½¿ç”¨ï¼Œé¿å…çµæœé ç©ºç™½èˆ‡æ‰‹æ©Ÿç‰ˆæ“æ“ ï¼‰ -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->
<!-- padding to preserve line count -->

</div>
                    </div>
                    
                    <!-- èƒ½é‡æ‰‹éŠæ¨è–¦å¡ç‰‡ -->
                    <div class="product-recommendation-card">
                        <div class="recommendation-header">
                            <i class="fas fa-gem"></i>
                            <h3>æƒ³æŠŠé€™ä»½çµæœåšæˆã€Œå°ˆå±¬äº”è¡Œæ‰‹éŠã€ï¼Ÿæˆ‘å¹«ä½ é…åˆ°ä½</h3>
                        </div>
                        <div class="recommendation-content">
                            <p class="recommendation-desc">ä¾ä½ çµæœçš„å–œç”¨ç¥ï¼Œçµ¦ä½  3 å€‹å¯¦ç”¨æ­é…ï¼ˆå¯ç›´æ¥ä¸‹å–®ï¼‰</p>
                            <div class="recommendation-buttons">
                                <a href="https://tw.shp.ee/2n5Mo2w" target="_blank" class="rec-btn rec-btn-shopee" rel="noopener noreferrer">
                                    <i class="fas fa-shopping-cart"></i>
                                    <div class="btn-text">
                                        <span class="btn-title">ğŸ›’ è¦çš®é€›é€›</span>
                                        <span class="btn-subtitle">å…¨é¤¨å…é‹ + é—œæ³¨9æŠ˜</span>
                                    </div>
                                </a>
                                <a href="https://myship.7-11.com.tw/seller/profile?id=GM2601091690232" target="_blank" class="rec-btn rec-btn-711" rel="noopener noreferrer">
                                    <i class="fas fa-box"></i>
                                    <div class="btn-text">
                                        <span class="btn-title">ğŸ“¦ è³£è²¨ä¾¿</span>
                                        <span class="btn-subtitle">æ»¿åƒå…é‹ / å¤šä»¶åˆä½µ</span>
                                    </div>
                                </a>
                                <button class="rec-btn rec-btn-custom" id="btn-custom-order">
                                    <i class="fas fa-magic"></i>
                                    <div class="btn-text">
                                        <span class="btn-title">âœ¨ æˆ‘è¦å®¢è£½</span>
                                        <span class="btn-subtitle">å¡«è³‡æ–™ / é ç®—ç‰ˆ</span>
                                    </div>
                                </button>
                            </div>
                            <div class="recommendation-note">
                                <i class="fas fa-info-circle"></i>
                                <span>é ç®—ç‰ˆ / åŠ å¼·ç‰ˆ / æ”¶è—ç‰ˆï¼šé¸ä¸€å€‹å°±å¥½</span>
                            </div>
                        </div>
                    </div>
    
                    <div class="master-summary">
                        <div class="summary-content">
                            <h4><i class="fas fa-moon"></i> éœæœˆåˆ†æå¸«ç¸½çµ</h4>
                            <div class="poetic-summary" id="poetic-summary">
                                </div>
                            <div class="final-advice" id="final-advice">
                                </div>
                        </div>
                    </div>
                </div>
    
                <!-- #result-action-bar ç”± ensureResultActionBar() åœ¨ loadResults() å¾Œ appendChild è‡³æœ¬ section æœ€å¾Œï¼Œä¸å¯«æ­»åœ¨ template ä»¥å…è·‘åˆ°å‰é¢ -->
            </section>
        </main>
        
        <!-- å®¢è£½è¡¨å–®æ¨¡æ…‹æ¡† -->
        <div class="custom-order-modal" id="custom-order-modal">
            <div class="modal-overlay"></div>
            <div class="modal-content-custom">
                <button class="modal-close-btn" id="close-custom-modal">
                    <i class="fas fa-times"></i>
                </button>
                <div class="modal-header-custom">
                    <i class="fas fa-magic"></i>
                    <h2>èƒ½é‡æ‰‹éŠå®¢è£½æœå‹™</h2>
                </div>
                <form class="custom-order-form" id="custom-order-form">
                    <div class="form-group-custom">
                        <label for="custom-name"><i class="fas fa-user"></i> å§“å</label>
                        <input type="text" id="custom-name" name="name" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
                    </div>
                    <div class="form-group-custom">
                        <label for="custom-birthday"><i class="fas fa-calendar"></i> å‡ºç”Ÿæ—¥æœŸ</label>
                        <input type="date" id="custom-birthday" name="birthday" required>
                    </div>
                    <div class="form-group-custom">
                        <label for="custom-question"><i class="fas fa-question-circle"></i> æƒ³è§£æ±ºçš„å•é¡Œ</label>
                        <textarea id="custom-question" name="question" rows="3" placeholder="ä¾‹å¦‚ï¼šæƒ³æå‡äº‹æ¥­é‹ã€æ”¹å–„æ„Ÿæƒ…ã€æ‹›è²¡ç­‰..." required></textarea>
                    </div>
                    <div class="form-group-custom">
                        <label for="custom-budget"><i class="fas fa-dollar-sign"></i> é ç®—ç¯„åœ</label>
                        <select id="custom-budget" name="budget" required>
                            <option value="">è«‹é¸æ“‡é ç®—ç¯„åœ</option>
                            <option value="é ç®—ç‰ˆï¼ˆ$1,000 - $3,000ï¼‰">é ç®—ç‰ˆï¼ˆ$1,000 - $3,000ï¼‰</option>
                            <option value="åŠ å¼·ç‰ˆï¼ˆ$3,000 - $6,000ï¼‰">åŠ å¼·ç‰ˆï¼ˆ$3,000 - $6,000ï¼‰</option>
                            <option value="æ”¶è—ç‰ˆï¼ˆ$6,000 ä»¥ä¸Šï¼‰">æ”¶è—ç‰ˆï¼ˆ$6,000 ä»¥ä¸Šï¼‰</option>
                        </select>
                    </div>
                    <div class="form-actions-custom">
                        <button type="button" class="btn-cancel" id="cancel-custom-form">å–æ¶ˆ</button>
                        <button type="submit" class="btn-submit-custom" id="submit-custom-form">
                            <i class="fas fa-paper-plane"></i> é€å‡ºè©¢å•
                        </button>
                    </div>
                    <div id="form-status" class="form-status-message" style="display: none; margin-top: 1rem; padding: 1rem; border-radius: var(--border-radius-sm); text-align: center;"></div>
                </form>
                
                <!-- éƒµä»¶å…§å®¹é¡¯ç¤ºå€ï¼ˆæäº¤å¾Œé¡¯ç¤ºï¼Œåœ¨è¡¨å–®å¤–ï¼‰ -->
                <div class="email-content-display" id="email-content-display" style="display: none;">
                    <div class="email-content-header">
                        <i class="fas fa-envelope-open"></i>
                        <h4>éƒµä»¶å…§å®¹å·²æº–å‚™å¥½</h4>
                    </div>
                    <div class="email-info-box">
                        <div class="email-info-item">
                            <label>ä¸»æ—¨ï¼š</label>
                            <div class="email-value-copy">
                                <span id="email-subject-display"></span>
                                <button class="btn-copy" id="copy-subject-btn" title="è¤‡è£½">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        <div class="email-info-item full-width">
                            <label>å…§å®¹ï¼š</label>
                            <div class="email-content-box">
                                <textarea id="email-body-display" readonly></textarea>
                                <button class="btn-copy-full" id="copy-body-btn" title="è¤‡è£½å…¨éƒ¨å…§å®¹">
                                    <i class="fas fa-copy"></i> è¤‡è£½å…¨éƒ¨å…§å®¹
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="email-instructions">
                        <i class="fas fa-info-circle"></i>
                        <p><strong>éƒµä»¶å…§å®¹å·²è‡ªå‹•è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼</strong></p>
                        <p>è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿç™¼é€éƒµä»¶ï¼š</p>
                        <ol style="margin: 0.5rem 0; padding-left: 1.5rem;">
                            <li>é–‹å•Ÿæ‚¨çš„éƒµä»¶æ‡‰ç”¨ç¨‹å¼ï¼ˆGmailã€Outlookã€Apple Mail ç­‰ï¼‰</li>
                            <li>é»æ“Šä¸‹æ–¹é€£çµï¼Œéƒµä»¶å®¢æˆ¶ç«¯æœƒè‡ªå‹•å¡«å…¥æ”¶ä»¶äººèˆ‡å…§å®¹</li>
                            <li>ç¢ºèªå¾Œé»æ“Šç™¼é€</li>
                        </ol>
                        <p class="email-alt-link" style="margin-top: 1rem;">è«‹é»æ“Šï¼š<a href="#" id="open-email-link" target="_blank" rel="noopener">é–‹å•Ÿéƒµä»¶å®¢æˆ¶ç«¯</a>ï¼ˆè¨­å‚™æ”¯æ´æ™‚æœƒè‡ªå‹•å¡«å…¥ï¼‰</p>
                    </div>
                </div>
            </div>
        </div>
        </div>
        </div>
        </div>
        <!-- #page-scroll çµæŸ -->

        <!-- å³å´æµ®å‹•æŒ‰éˆ•ï¼šbody ç›´å±¬å…¨åŸŸå±¤ï¼Œç”± JS æ¸²æŸ“åˆ° #global-floating-rootï¼Œé¿å… stacking context è¢«å…§å®¹è“‹ä½ -->
        <div id="global-floating-root" aria-label="å…¨ç«™æµ®å‹•æ“ä½œ"></div>
    
        <!-- scroll-rescue.js å·²ç§»é™¤ï¼šæ­¢è¡€ï¼Œé¿å… monkey patch èˆ‡å…¨åŸŸ overflow è¦†è“‹ -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lunar-javascript/1.7.4/lunar.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/iztro@2/dist/iztro.min.js"></script>
        <script src="js/scrollLockManager.js?v=HOTFIX-20260203-E"></script>
        <script src="js/scroll-debug.js?v=HOTFIX-20260203-E"></script>
        <script src="js/ziwei-system.js?v=HOTFIX-20260203-E"></script>
        <script src="js/true-solar-time.js?v=HOTFIX-20260203-E"></script>
        <script src="js/solar-term-calculator.js?v=HOTFIX-20260203-E"></script>
        <script src="js/shichen-system.js?v=HOTFIX-20260203-E"></script>
        <script src="js/dayun-calculator.js?v=HOTFIX-20260203-E"></script>
        <script src="js/liunian-calculator.js?v=HOTFIX-20260203-E"></script>
        <script src="js/auxiliary-data.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/chenggu.js?v=HOTFIX-20260203-E"></script>
        <script src="js/bazi-system.js?v=HOTFIX-20260203-E"></script>
        <script src="js/fortune-judgment-engine.js?v=HOTFIX-20260203-E"></script>
        <script src="js/quality-mapper.js?v=HOTFIX-20260203-E"></script>
        <script src="js/meihua-system.js?v=HOTFIX-20260203-E"></script>
        <script src="js/nameology-system.js?v=HOTFIX-20260203-E"></script>
        <script src="js/tarot-system.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/tarot_meanings_by_type.js?v=HOTFIX-20260203-E"></script>
        <script src="js/tarot-golden-dawn-system.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/celtic_positions.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/bazi_interpreter.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/meihua_rules.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/crystal_behavior_map.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/fusion_crystal_engine.js?v=HOTFIX-20260203-E"></script>
        <script src="data/crystals_kb.js?v=HOTFIX-20260203-E"></script>
        <script src="data/vendor_inventory.js?v=HOTFIX-20260203-E"></script>
        <script src="js/crystal-evidence-normalizer.js?v=HOTFIX-20260203-E"></script>
        <script src="js/crystal-recommender.js?v=HOTFIX-20260203-E"></script>
        <script src="js/crystal-advice-synthesizer.js?v=HOTFIX-20260203-E"></script>
        <script src="js/crystal-output-guard.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/vocabulary_db.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/time_scope_parser.js?v=HOTFIX-20260203-E"></script>
        <script src="js/question-parser.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/meihua_evidence_data.js?v=HOTFIX-20260203-E"></script>
        <script src="js/evidence-normalizer.js?v=HOTFIX-20260203-E"></script>
        <script src="js/evidence-selector.js?v=HOTFIX-20260203-E"></script>
        <script src="js/answer-synthesizer.js?v=HOTFIX-20260203-E"></script>
        <script src="js/alignment-guard.js?v=HOTFIX-20260203-E"></script>
        <script src="js/explainability-layer.js?v=HOTFIX-20260203-E"></script>
        <script src="js/explainability-guard.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/category_strategy.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/domain_symbol_mapping.js?v=HOTFIX-20260203-E"></script>
        <script src="logic/finance_lottery_mapping.js?v=HOTFIX-20260203-E"></script>
        <script src="js/response-validator.js?v=HOTFIX-20260203-E"></script>
        <script src="engine/fusionEngine.js?v=HOTFIX-20260203-E"></script>
        <script src="js/method-selector.js?v=HOTFIX-20260203-E"></script>
        <script src="js/probability-calculators.js?v=HOTFIX-20260203-E"></script>
        <script src="js/probability-integration.js?v=HOTFIX-20260203-E"></script>
        <script src="js/scoring-engine.js?v=HOTFIX-20260203-E"></script>
        <script src="js/probability-pipeline.js?v=HOTFIX-20260203-E"></script>
        <script src="js/crystal-recommendation.js?v=HOTFIX-20260203-E"></script>
        <script src="js/main.js?v=HOTFIX-20260203-E"></script>
        <script>
            /* æš«æ™‚åœç”¨ SWï¼Œç¢ºä¿æ”¹ç‰ˆç«‹å³ç”Ÿæ•ˆï¼›ä¿®å¾©å®Œæˆå¾Œå¯æ¢å¾© */
            /* if ('serviceWorker' in navigator) {
                window.addEventListener('load', function() { navigator.serviceWorker.register('./sw.js?v=HOTFIX-20260203-E').catch(function(){}); });
            } */
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=1') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/qa_alignment_tests.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runQAAlignmentTests === 'function') {
                            var res = runQAAlignmentTests();
                            window.qaAlignmentTestResult = res;
                            var block = document.createElement('div');
                            block.id = 'qa-alignment-test-block';
                            block.setAttribute('aria-live', 'polite');
                            block.style.cssText = 'position:fixed;bottom:0;left:0;right:0;background:#1a1520;color:#D4AF37;border-top:2px solid #D4AF37;padding:10px 16px;font-size:14px;max-height:180px;overflow:auto;z-index:9999;';
                            block.innerHTML = '<strong>QA å°é½Šæ¸¬è©¦</strong> é€šé ' + (res.passed || 0) + ' / ' + (res.total || 0) + (res.failed ? 'ã€€å¤±æ•— ' + res.failed + ' é¡Œ' : '') +
                                (res.failures && res.failures.length ? '<br>å¤±æ•—ï¼ˆå‰5ï¼‰: ' + res.failures.slice(0, 5).map(function(f){ return f.q + ' â†’ ' + f.reason; }).join(' | ') : '');
                            document.body.appendChild(block);
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=category') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/category_difference_test.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runCategoryDifferenceTest === 'function') {
                            var res = runCategoryDifferenceTest();
                            window.categoryDifferenceTestResult = res;
                            console.log('[Category Test] åŸ·è¡Œå®Œç•¢ï¼Œçµæœè¦‹ categoryDifferenceTestResult');
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=lottery') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/lottery_intent_tests.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runLotteryIntentTests === 'function') {
                            var res = runLotteryIntentTests();
                            window.lotteryIntentTestResult = res;
                            console.log('[Lottery Test] é€šé ' + (res.passed || 0) + ' / ' + (res.total || 0), res.failures && res.failures.length ? res.failures : '');
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=intent') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/intent_domain_tests.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runIntentDomainTests === 'function') {
                            var res = runIntentDomainTests();
                            window.intentDomainTestResult = res;
                            console.log('[Intent/Domain Test] é€šé ' + (res.passed || 0) + ' / ' + (res.total || 0), res.failures && res.failures.length ? res.failures : '');
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=crystal') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/crystal_recommendation_tests.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runCrystalRecommendationTests === 'function') {
                            var res = runCrystalRecommendationTests();
                            window.crystalRecommendationTestResult = res;
                            var block = document.createElement('div');
                            block.id = 'crystal-recommendation-test-block';
                            block.setAttribute('aria-live', 'polite');
                            block.style.cssText = 'position:fixed;bottom:0;left:0;right:0;background:#1a1520;color:#D4AF37;border-top:2px solid #D4AF37;padding:10px 16px;font-size:14px;max-height:180px;overflow:auto;z-index:9999;';
                            block.innerHTML = '<strong>æ°´æ™¶å»ºè­°æ¸¬è©¦</strong> é€šé ' + (res.passed || 0) + ' / ' + (res.total || 0) + (res.failed ? 'ã€€å¤±æ•— ' + res.failed + ' é¡Œ' : '') +
                                (res.failures && res.failures.length ? '<br>å¤±æ•—ï¼ˆå‰5ï¼‰: ' + res.failures.slice(0, 5).map(function(f){ return f.q + ' â†’ ' + f.reason; }).join(' | ') : '');
                            document.body.appendChild(block);
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
            if (typeof window !== 'undefined' && window.location && window.location.search.indexOf('test=chenggu') >= 0) {
                (function(){
                    var s = document.createElement('script');
                    s.src = 'tests/chenggu_tests.js?v=HOTFIX-20260203-E';
                    s.onload = function(){
                        if (typeof runChengguTests === 'function') {
                            var res = runChengguTests();
                            window.chengguTestResult = res;
                            console.log('[ç¨±éª¨æ¸¬è©¦] é€šé ' + (res.passed || 0) + ' / ' + ((res.passed || 0) + (res.failed || 0)) + (res.failed ? 'ï¼Œå¤±æ•— ' + res.failed : ''));
                            if (res.errors && res.errors.length) console.warn('[ç¨±éª¨æ¸¬è©¦] éŒ¯èª¤', res.errors);
                        }
                    };
                    document.body.appendChild(s);
                })();
            }
        </script>
        <!-- ç´…é‡‘ä¸»é¡Œç”± theme-red-gold.css å¥—ç”¨ï¼›ä¸è¼‰å…¥ force-modern-ui.js ä»¥å…å…§è¯æ¨£å¼è¦†è“‹ä¸»é¡Œ -->

        <!-- UI Flow Hotfix Script | HOTFIX-20260208-UIFLOW -->
        <script>
        (function(){
            function qs(sel, root){ return (root || document).querySelector(sel); }
            function qsa(sel, root){ return Array.prototype.slice.call((root || document).querySelectorAll(sel)); }

            function safeText(el){ return (el && (el.textContent || el.innerText || '') || '').trim(); }

            function bindQuickStart(){
                var btn = qs('#btn-quick-start');
                var target = qs('#input-section');
                if (!btn || !target) return;
                btn.addEventListener('click', function(){
                    try{
                        target.scrollIntoView({behavior:'smooth', block:'start'});
                        var firstField = qs('#question-type');
                        if (firstField) setTimeout(function(){ firstField.focus(); }, 400);
                    }catch(e){}
                });
            }

            function addTermChips(){
                // 3) Jargon softening: add small info chips with title text
                var mapping = [
                    { sel: '#solar-time-heading', title: 'ç”¨å‡ºç”Ÿåœ°ç¶“åº¦æŠŠé˜éŒ¶æ™‚é–“å¾®èª¿æˆã€Œæ›´æ¥è¿‘å¤ªé™½ä½ç½®ã€çš„æ™‚é–“ï¼Œç”¨ä¾†æé«˜æ™‚æŸ±èˆ‡èµ·é‹è¨ˆç®—ç²¾æº–åº¦ï¼ˆä¸å•Ÿç”¨ä¹Ÿå¯åˆ†æï¼‰ã€‚' },
                    { sel: 'label[for="birth-time"]', title: 'ä¸ç¢ºå®šå°±ç•™ç©ºï¼šç³»çµ±æœƒç”¨ 12:00 ä¼°ç®—ï¼›è‹¥ä½ å¾ˆåœ¨æ„æ™‚æŸ±æº–åº¦å†è£œå¡«ã€‚' },
                    { sel: '.hexagram-details .detail-label', title: 'é€™äº›æ˜¯æ˜“ç¶“å…§éƒ¨åˆ¤è®€æ¬„ä½ï¼›ä½ åªè¦çœ‹ã€Œè§£è®€ã€èˆ‡ã€Œå»ºè­°ã€å³å¯ã€‚' }
                ];
                mapping.forEach(function(m){
                    var el = qs(m.sel);
                    if (!el) return;
                    if (el.querySelector && el.querySelector('.term-chip')) return;
                    var chip = document.createElement('span');
                    chip.className = 'term-chip';
                    chip.setAttribute('title', m.title);
                    chip.setAttribute('aria-label', m.title);
                    chip.textContent = 'â„¹ï¸';
                    el.appendChild(chip);
                });
            }

            function softenShopCtaEarly(){
                // 6) Not part of 1-5, but keep non-invasive: do nothing here (reserved)
            }

            function verdictFromProbability(pct){
                if (pct >= 70) return { label: 'åå‘å¯è¡Œ âœ…', reason: 'å¤šç¶­åº¦æŒ‡æ¨™åä¸€è‡´ï¼Œé©åˆæ¨é€²ï¼Œä½†ä»éœ€æŒ‰å»ºè­°æ§é¢¨éšªã€‚' };
                if (pct >= 45) return { label: 'ä¸­æ€§åå¯è¡Œ âš–ï¸', reason: 'æœ‰åˆ©èˆ‡é˜»åŠ›ä¸¦å­˜ï¼›ç…§å»ºè­°èª¿æ•´åšæ³•ï¼Œå‹ç‡æœƒä¸Šå‡ã€‚' };
                if (pct >= 25) return { label: 'åä¿å®ˆ âš ï¸', reason: 'é˜»åŠ›è¨Šè™Ÿè¼ƒå¤šï¼Œå»ºè­°å…ˆé™ä½æˆæœ¬/è©¦æ°´æº«ï¼Œå†è«‡æ”¾å¤§ã€‚' };
                return { label: 'ä¸å»ºè­°ç¡¬æ¨ â›”', reason: 'ç›®å‰è±¡å¾µåé€†é¢¨ï¼›è‹¥è¦åšï¼Œå‹™å¿…è¨­åœæèˆ‡æ›¿ä»£æ–¹æ¡ˆã€‚' };
            }

            function bindFirstLookObserver(){
                var probEl = qs('#overall-probability');
                var ansEl = qs('#direct-answer');
                var outVerdict = qs('#firstlook-verdict');
                var outProb = qs('#firstlook-prob');
                var outReason = qs('#firstlook-reason');
                if (!probEl || !ansEl || !outVerdict || !outProb || !outReason) return;

                function refresh(){
                    var pctText = safeText(probEl).replace('%','');
                    var pct = parseFloat(pctText);
                    if (isNaN(pct)) pct = 0;
                    var v = verdictFromProbability(pct);
                    outVerdict.textContent = v.label;
                    outProb.textContent = 'å¯èƒ½æ€§ï¼š' + Math.round(pct) + '%';

                    // Use a short reason + (optional) first line from direct answer
                    var direct = safeText(ansEl);
                    var directOneLine = direct ? direct.split('\n')[0].slice(0, 60) : '';
                    outReason.textContent = (directOneLine ? ('åŸå› ï¼š' + directOneLine + ' / ') : 'åŸå› ï¼š') + v.reason;
                }

                // Mutation observer for dynamic update
                var mo = new MutationObserver(function(){ refresh(); });
                mo.observe(probEl, { childList:true, subtree:true, characterData:true });
                mo.observe(ansEl, { childList:true, subtree:true, characterData:true });
                refresh();
            }

            function relaxAdvancedRequiredSafety(){
                // Ensure advanced fields are not blocking Step1
                var country = qs('#birth-country');
                var city = qs('#birth-city');
                if (country) country.removeAttribute('required');
                if (city) city.removeAttribute('required');
            }

            document.addEventListener('DOMContentLoaded', function(){
                bindQuickStart();
                addTermChips();
                bindFirstLookObserver();
                relaxAdvancedRequiredSafety();
            });
        })();
        </script>

    </body>
    </html>