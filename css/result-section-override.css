/**
 * Section 5 滿版：突破 .main-container 的 max-width / padding，與 Bazi 視覺一致
 * 使用 viewport breakout 讓 #result-section 佔滿 100vw，內文用 2rem 與 main-container 對齊
 */
/* sticky 父層不可 overflow: hidden（會剪裁/異常）；僅 overflow-x 隱藏橫向溢出 */
#result-section.section,
section#result-section {
  width: 100vw !important;
  max-width: 100vw !important;
  position: relative !important;
  left: 50% !important;
  right: 50% !important;
  margin-left: -50vw !important;
  margin-right: -50vw !important;
  padding: clamp(12px, 2.5vw, 18px) clamp(12px, 2.5vw, 18px) !important;
  padding-bottom: 120px !important;
  box-sizing: border-box !important;
  overflow-x: hidden !important;
  overflow-y: visible !important;
}

#result-section .bazi-container {
  width: 100% !important;
  max-width: none !important;
  margin: 0 !important;
  padding: 0 !important;
  box-sizing: border-box !important;
}

/* 右側浮動按鈕已改由 #global-floating-root 渲染，樣式見 main.css */
#global-floating-root #floating-buttons,
#floating-buttons.floating-buttons {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
}
#global-floating-root #floating-buttons .floating-btn,
#global-floating-root #floating-buttons a,
#global-floating-root #floating-buttons button {
  pointer-events: auto !important;
}

@media (max-width: 768px) {
  #result-section.section,
  section#result-section {
    padding: clamp(12px, 2.5vw, 18px) max(1rem, env(safe-area-inset-right, 1rem)) max(150px, calc(150px + env(safe-area-inset-bottom, 0))) max(1rem, env(safe-area-inset-left, 1rem)) !important;
  }
}

/* 【答案】區塊：影響因子與建議列表 */
#section-answer .answer-factors,
#section-answer .answer-suggestions {
  margin-top: 1rem;
  padding-top: 0.75rem;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
}
#section-answer .answer-factors h4,
#section-answer .answer-suggestions h4 {
  font-size: 0.95rem;
  color: var(--gold-primary, #D4AF37);
  margin-bottom: 0.5rem;
}
#answer-factors-list,
#answer-suggestions-list {
  margin: 0;
  padding-left: 1.25rem;
  line-height: 1.7;
  color: rgba(255,255,255,0.9);
}

/* 直接回答：原理參考（八字身強身弱、喜用神等）縮小字體、次要顯示 */
.principle-ref {
  display: none;
  font-size: 0.85rem !important;
  color: rgba(255,255,255,0.65) !important;
  margin-top: 0.5rem;
  line-height: 1.5;
}
.principle-ref:not(:empty) {
  display: block;
}

/* 結果頁：影響因子／建議 展開收合，手機預設收合、桌機預設展開 */
.details-expand {
  margin-top: 0.5rem;
}
.details-summary {
  cursor: pointer;
  color: var(--gold-primary, #D4AF37);
  font-size: 0.9rem;
  list-style: none;
  padding: 0.35rem 0;
}
.details-summary::-webkit-details-marker { display: none; }
.details-summary::before { content: '▶ '; font-size: 0.7rem; }
details[open] .details-summary::before { content: '▼ '; }
@media (min-width: 769px) {
  #section-answer .details-factors[data-desktop-open],
  #section-answer .details-suggestions[data-desktop-open] {
    /* 桌機由 JS 設 open 屬性 */
  }
}
/* 直接回答禁止截斷：完整顯示 (1)(2)(3) 條列，手機也不可 line-clamp 或 overflow:hidden */
@media (max-width: 768px) {
  .answer-text-summary {
    display: block !important;
    -webkit-line-clamp: unset !important;
    -webkit-box-orient: unset !important;
    overflow: visible !important;
    max-height: none !important;
    height: auto !important;
    white-space: normal !important;
  }
}

/* 五行百分比不換行 */
.element-value,
.element-percentage-text,
.element-value-text {
  white-space: nowrap !important;
  min-width: fit-content !important;
  flex-shrink: 0 !important;
  text-align: right !important;
  font-size: 0.85rem !important;
}
#result-section .analysis-card-wuxing .element-value,
#result-section .analysis-card-wuxing .element-percentage-text,
#result-section .analysis-card-wuxing .element-value-text {
  white-space: nowrap !important;
  min-width: fit-content !important;
  flex-shrink: 0 !important;
}
#result-section .analysis-card-wuxing .element-row .progress-track,
.element-row .progress-track,
.element-progress-bar {
  flex: 1 1 auto !important;
  min-width: 0 !important;
  max-width: calc(100% - 100px) !important;
}
.element-row {
  align-items: center !important;
  flex-wrap: nowrap !important;
}
